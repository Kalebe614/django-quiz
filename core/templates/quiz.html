{% extends 'base.html' %}
{% load static %}
{% block head %}
<title>Questions Quiz</title>
<link rel="stylesheet" href="{% static 'css/quiz.css' %}">
{% endblock head %}
{% block content %}

<!--Quiz-->
<div class="box">
   <div class="container">
      <div id="title-quiz">
         <h1>Quiz</h1>
      </div>

      <!--Questions Quiz-->
      {% for question in questions %}

      <!--Show first question-->
      {% if  forloop.first%}
      <div id=number-{{ forloop.counter }} class="show-question">
         {% else %}
         <div id=number-{{ forloop.counter }} class="hidden-question">
            {% endif %}
            <div id="question">
               <p>{{question}} </p>
            </div>

            <!--Answers-->
            <div id="box-responses">
               {% for answer  in question.answer_question.all %}      
               <div class="questions">
                  <a href="#" class="btn-questions">{{answer}}</a>
               </div>
               {% endfor %}
            </div>
         </div>

         <!--Commands-->
         {% endfor %}
         <div id="commands">
            <span id="count">Question: <span id="current-counter">1</span><span id="total-questions" data-total="{{ questions|length }}"> of {{ questions|length }}"</span><a href="#" id="btn-next">Next</a>
         </div>
      </div>
   </div>
   
{% include 'result.html' %}


<script>
   let idCurrentQuestion = 1 //Position question initial

   //Get total number of questions
   const totalQuestions = document.getElementById('total-questions')
   const total =  parseInt(totalQuestions.getAttribute('data-total'))

   const counter = document.getElementById("current-counter") //Span Counter of current question

   let btnNext = document.getElementById('btn-next') //Button Next

   let currentQuestion = document.getElementById(`number-${idCurrentQuestion}`);//Div Current Question
   
   //Call the next question
   btnNext.onclick = function(event){
     
      event.preventDefault()

      if (idCurrentQuestion == total){
         showResult()
      }else {
         showNextQuestion()
      }
      
   }

   //Hide the answered question and show the next question
   function showNextQuestion(){

      currentQuestion.setAttribute('class', 'hidden-question')
       
      idCurrentQuestion +=1 //Update currrent question
      
      counter.innerHTML = idCurrentQuestion //Update current counter

      currentQuestion = document.getElementById(`number-${idCurrentQuestion}`)
      
      currentQuestion.setAttribute('class', 'show-question')
   }

function showResult(){
   document.querySelector('div[class=box]').style.display = "none"
   document.querySelector('div[class=container-result]').style.display= "block"
}

</script>
{% endblock content %}